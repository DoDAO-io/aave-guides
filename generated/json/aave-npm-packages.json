{
  "uuid": "0de15878-df46-4b62-a536-d1446d3eef80",
  "key": "aave-npm-packages",
  "name": "AAVE NPM Packages",
  "content": "Explains the important NPM packages",
  "guideType": "onboarding",
  "created": "2022-08-02T04:15:13.911Z",
  "categories": [
    "developer"
  ],
  "thumbnail": "https://d31h13bdjwgzxs.cloudfront.net/guides/eth/aave/AAVE_NPM_Packages.png",
  "publishStatus": "Live",
  "socialShareImage": null,
  "showIncorrectOnCompletion": true,
  "steps": [
    {
      "uuid": "5db956ef-4e00-4ac1-8c25-64c5dbebfa73",
      "name": "@aave/core-v3, @aave/core-v2\n",
      "content": "\n## @aave/coreV3 (https://www.npmjs.com/package/@aave/core-v3)\n\nThis package contains the smart contracts source code and markets configuration related to Aave Protocol V3. \nIt uses Docker Compose and Hardhat as development environment for compilation, testing and deployment tasks.\n\nYou can install @aave/aave-v3-core as an npm package to your hardhat or truffle workspace to get access to contracts and \ninterfaces provided by Aave V3\n\nYou can install `@aave/core-v3` as an NPM package in your Hardhat or Truffle project to import the contracts and interfaces:\n\n`npm install @aave/core-v3`\n\nImport at Solidity files:\n\n```solidity\n  import {IPool} from \"@aave/core-v3/contracts/interfaces/IPool.sol\";\n\n  contract Misc {\n\n    function supply(address pool, address token, address user, uint256 amount) public {\n      IPool(pool).supply(token, amount, user, 0);\n      {...}\n    }\n  }\n```\n\nThe JSON artifacts with the ABI and Bytecode are also included into the bundled NPM package at `artifacts/` directory.\n\nImport JSON file via Node JS `require`:\n\n```\n  const PoolV3Artifact = require('@aave/core-v3/artifacts/contracts/protocol/pool/Pool.sol/Pool.json');\n\n  // Log the ABI into console\n  console.log(PoolV3Artifact.abi)\n```\n\n## @aave/protocol-v2 (https://www.npmjs.com/package/@aave/protocol-v2)\nPackage contains smart contracts related to v2.\n\nJust like @aave/core-v3, you can  install @aave/protocol-v2 as an NPM package by running `npm install @aave/protocol-v2`\n\nYou can import Solidity and ABI files, just like the V3 files shown above. \n",
      "stepItems": []
    },
    {
      "uuid": "94c7d162-1dc7-48a8-bd9c-9da32acb6382",
      "name": "Evaluation",
      "content": "",
      "stepItems": [
        {
          "uuid": "bed785bb-b626-42f5-86ef-023a31033682",
          "content": "The smart contract source code and market configurations are contained within which repo?",
          "answerKeys": [
            "A"
          ],
          "type": "SingleChoice",
          "choices": [
            {
              "content": "Aave core V3",
              "key": "A"
            },
            {
              "content": "Math util",
              "key": "B"
            },
            {
              "content": "Lens protocol",
              "key": "C"
            },
            {
              "content": "None of these",
              "key": "D"
            }
          ]
        },
        {
          "uuid": "41e5ceb5-058e-463b-8033-62f17b5070cd",
          "content": "Aave V3 uses which of these tools to set-up development environment?",
          "answerKeys": [
            "C",
            "B"
          ],
          "type": "MultipleChoice",
          "choices": [
            {
              "content": "Truffle",
              "key": "A"
            },
            {
              "content": "Hardhat",
              "key": "B"
            },
            {
              "content": "Docker Compose",
              "key": "C"
            },
            {
              "content": "None of these",
              "key": "D"
            }
          ]
        }
      ]
    },
    {
      "uuid": "16959203-96fa-4b9a-ac7b-67e0905d7533",
      "name": "@aave/aave-token\n",
      "content": "## @aave/aave-token (https://www.npmjs.com/package/@aave/aave-token):\nThe AAVE token is an ERC-20 compatible token that implements governance-inspired features. This will allow Aave to bootstrap the rewards program for safety and ecosystem growth. \n\n**Roles:**\nThe original AAVE token contract does not have any administrator roles set up. The contract will use the Openzeppelin implementation of the EIP-1967 Transparent Proxy pattern, which will have an administrator role. \nThe proxy's administrator will be set when the contract is deployed to the Aave governance contracts.\n\nThe AAVE token implements the standard methods of the ERC-20 interface, with a balance snapshot feature to keep track of the balances of users at specific block heights. This is helpful for the Aave governance integration of AAVE.\nAAVE also integrates the EIP 2612 permit function - which allows gasless transactions and one tx approval/transfer.\n\n**LendToAaveMigrator:**\nIt is the smart contract for LEND token holders to execute the migration to the AAVE token, using part of the initial emission of AAVE for it.\n\nThe contract is covered by a proxy, whose owner will be the AAVE governance. \nOnce the governance passes the corresponding proposal, the proxy will be connected to the implementation and LEND holders will be able to call the migrateFromLend() function, \nwhich, after LEND approval, will pull LEND from the holder wallet and transfer back an equivalent AAVE amount defined by the LEND_AAVE_RATIO constant.\n\nForm the npm docs,\nOne tradeOff of migrateFromLend() is that, as the AAVE total supply will be lower than LEND, the LEND_AAVE_RATIO will be always > 1, causing a loss of precision for amounts of LEND that are not multiple of LEND_AAVE_RATIO. E.g. a person sending 1.000000000000000022 LEND, with a LEND_AAVE_RATIO == 100, will receive 0.01 AAVE, losing the value of the last 22 small units of LEND. \nTaking into account the current value of LEND and the future value of AAVE, a lack of precision for less than LEND_AAVE_RATIO small units represents a value several orders of magnitude smaller than 0.01$. \n\n**Redemption process:**\nThe Aave team will be responsible for the first step in bootstrapping AAVE emissions by deploying the AAVE token contract and the LendToAaveMigrator contract. Upon deployment, the ownership of the Proxy of the AAVE contract and the LendToAaveMigrator will be transferred to the Aave Governance. \nIn order to start the LEND redemption process at that point, the Aave team will create an AIP (Aave Improvement Proposal) and submit it as a proposal to the Aave governance for approval.\nThe proposal will, once approved, activate the LEND/AAVE redemption process and the ecosystem incentives, which will mark the initial emission of AAVE on the market. The result of the migration procedure will see the supply of LEND being progressively locked within the new AAVE smart contract, while at the same time an equivalent amount of AAVE is being issued. The amount of AAVE equivalent to the LEND tokens burned in the initial phase of the AAVE protocol will remain locked in the LendToAaveMigrator contract. \nIn other words, when you redeem your LEND tokens for AAVE, you're also locking up an equivalent amount of AAVE in order to ensure that there's no net increase in the total supply of AAVE.\n\nThe smartcontract can then be deployed to the testnet or the mainnet.\n",
      "stepItems": []
    },
    {
      "uuid": "097ed24e-61a8-4cf0-b7f3-c17f9de71621",
      "name": "Evaluation",
      "content": "",
      "stepItems": [
        {
          "uuid": "99ef03d5-d010-40da-aa36-b9a816797905",
          "content": "Does the original Aave token have an administrator role set up?",
          "answerKeys": [
            "A"
          ],
          "type": "SingleChoice",
          "choices": [
            {
              "content": "No",
              "key": "A"
            },
            {
              "content": "Yes",
              "key": "B"
            }
          ]
        },
        {
          "uuid": "9a8229eb-f548-4596-b938-7d7f63dc6adb",
          "content": "Aave token is a?\n",
          "answerKeys": [
            "C"
          ],
          "type": "SingleChoice",
          "choices": [
            {
              "content": "ERC721",
              "key": "A"
            },
            {
              "content": "ERC42",
              "key": "B"
            },
            {
              "content": "ERC20",
              "key": "C"
            },
            {
              "content": "none of these",
              "key": "D"
            }
          ]
        },
        {
          "uuid": "79207d77-d940-4887-a759-06d218838cba",
          "content": "Aave integrates EIP-2612 permit function.\n",
          "answerKeys": [
            "A"
          ],
          "type": "SingleChoice",
          "choices": [
            {
              "content": "true\n",
              "key": "A"
            },
            {
              "content": "false\n",
              "key": "B"
            }
          ]
        }
      ]
    },
    {
      "uuid": "f800407f-477c-43f4-abd7-0839496e09de",
      "name": "@aave/contract-helpers, @aave/math-utils,  @aave/periphery-v3\n",
      "content": "\n## @aave/contract-helpers (https://www.npmjs.com/package/@aave/contract-helpers):\nThe @aave/contract-helpers package offers a set of services which allow querying aggregated on-chain data via rpc.\nIt contains methods for generating transacations based on method and parameter inputs. Basically, it is used to \nread and write data on the protocol contracts. Could be thought of like something that facilitates the querying and writing of \ndata from and onto the original aave protocol.\nIt is part of a larger package, aave-utilities. Aave Utilities is a JavaScript SDK for interacting with V2 and V3 of the Aave Protocol\n\n## @aave/math-utils (https://www.npmjs.com/package/@aave/math-utils):\nThe @aave/math-utils data formatting methods act as a layer on top of the chain data. \nThe use-cases range from \"human readable formatting\" to \"approximating accrual over time.\"\nWe know users interact with the aave protocol using smartcontracts, @aave/math-utils package is a collection of methods to take raw input data \nfrom these contracts, and format to use on a frontend interface such as Aave Ui or Aave info.\n\nmath-utils package formats two types of data, raw and indexed contract data, for front-end usage.\nThese input data can be obtained from different ways, such as\n * ethers.js: \n   ethers.js is used to obtain raw contract data. \n   ethers.js is a library for interacting with Ethereum and other EVM compatible blockchains.\n\n * subgraph:\n   It is used to obtain indexed data type. Subgraphs work by indexing events that come from smart contracts. \n   This allows for data to be queried via a graphql endpoint. In other words, for each network where the protocol is deployed, there is a subgraph that corresponds to it.\n \n * Caching servers:\n   The Aave UI uses decentralized hosting with IPFS, which means that it doesn't require any API keys to run. However, this also means that only public rpc endpoints can be used, which are quickly rate-limited. \n   To respond for this, Aave has published a caching server. Caching server queries for data from the smart contracts and then sends it to the frontend users through different \n   GraphQL endpoints. Caching servers provide indexed data from smart contracts.\n   \n   (Note: GraphQL has been mentioned multiple times, for those who are unfamiliar - it is an open-source data query and manipulation language for APIs, and a runtime for fulfilling queries with existing data.)\n\n## @aave/periphery-v3 (https://www.npmjs.com/package/@aave/periphery-v3): \nThis repository contains the Rewards Controller contract, which allows you to incentivize assets with multiple rewards in Aave V3 markets. \nIt also contains UI helpers and other external smart contracts utilities related to the Aave Protocol V3.\n",
      "stepItems": []
    },
    {
      "uuid": "d43cb58b-ae6b-497a-8d56-cdcc0d077090",
      "name": "Evaluation",
      "content": "",
      "stepItems": [
        {
          "uuid": "a03824f0-73a2-4448-89fa-d78713cdbef6",
          "content": "which package offers a set of services which allow querying aggregated on-chain data?\n",
          "answerKeys": [
            "C"
          ],
          "type": "SingleChoice",
          "choices": [
            {
              "content": "UI kit",
              "key": "A"
            },
            {
              "content": "Math utils",
              "key": "B"
            },
            {
              "content": "Contract helpers",
              "key": "C"
            },
            {
              "content": "All of these",
              "key": "D"
            }
          ]
        },
        {
          "uuid": "a2e3fdd9-2505-4e0e-9cb5-904ecf635f46",
          "content": "Which of these acts as a layer on top of the existing chain-data?",
          "answerKeys": [
            "B"
          ],
          "type": "MultipleChoice",
          "choices": [
            {
              "content": "UI kit",
              "key": "A"
            },
            {
              "content": "Math utils",
              "key": "B"
            },
            {
              "content": "Contract helpers",
              "key": "C"
            },
            {
              "content": "Aave tokens",
              "key": "D"
            }
          ]
        },
        {
          "uuid": "27d319c1-c5ac-409d-b075-1a05a4140f03",
          "content": "mathutils formats which of these following data for use in frontend?",
          "answerKeys": [
            "A",
            "B"
          ],
          "type": "MultipleChoice",
          "choices": [
            {
              "content": "ethers.js",
              "key": "A"
            },
            {
              "content": "indexed data",
              "key": "B"
            },
            {
              "content": "hardhat",
              "key": "C"
            },
            {
              "content": "None of these",
              "key": "D"
            }
          ]
        }
      ]
    },
    {
      "uuid": "48b327fc-9ad8-481c-8948-989dad8020e1",
      "name": "@aave/protocol-js, @aave/safety-module, @aave/protocol-v2\n",
      "content": "\n## @aave/protocol-js (https://www.npmjs.com/package/@aave/protocol-js):\nAAVE is a decentralized non-custodial liquidity market protocol where users can participate as depositors or borrowers. \nThe AAVE Protocol is a set of open source smart contracts which facilitate the lending and borrowing of user funds. These contracts, \nand all user transactions/balances are stored on a public ledger called a blockchain, making them accessible to anyone.\n\nethers js, something we discussed about earlier, is a peer dependancy (PeerDependency, it is not automatically installed. Instead, the code that includes the package must include it as its dependency.) for protocol-js.\n\n\nIt encloses various transaction methods and the **Lending pool V2**, of which we have talked about in detail. For a short summary,\nLending pool is just a smart contract which acts as a reserve (pool) of assets, lent by liquidity providers for the protocol to use\nfor loaning. It contains methods like deposit, borrow, repay, withdraw, etc which can be called by users via smartcontracts.\nIt also encloses other vast concepts like aave governance.\n\nThe aave-js data formatting methods are a layer beyond graphql which wraps protocol data into more usable formats. Each method will require inputs from AAVE subgraph queries.\nAs you can see, we have already discussed about formatting packages (@aave/math-utils), these features are enclosed in this package. It has data formatting services which allow the querying of \nUser data and reserve data. \n\n\n\nYou can install protocol-js, but first install ethers.js\n\nnpm install --save ethers\n\nthen install protocol-js by,\n\nnpm install --save ethers\n\n\n\n## @aave/safety-module (https://www.npmjs.com/package/@aave/safety-module):\nThe Aave Protocol is secured by a smart contract-based component called the Safety Module (SM). AAVE holders can lock tokens into the SM to incentivize them to act as a \nmitigation tool in case of a Shortfall Event within the Aave ecosystem. A Shortfall Event occurs when there is a deficit in one of the money markets that belong \nto the Aave ecosystem. The interpretation for the occurrence of a Shortfall Event is subject to the Protocol Governance vote.\n\nThe Safety Module is designed to work with existing AMM technologies. The module will have an 80% AAVE/20% ETH liquidity pool that uses Balancer. This is meant to provide benefits like market depth for the AAVE token and earnings from locking AAVE. \nThe module will also cover BAL tokens and trading fees. Plus, it will reduce the impact of a Shortfall Event on the AAVE token.\nIn the event of a Shortfall, a portion of the locked AAVE is auctioned off to be sold in order to make up for the deficit. The SM has a built-in backstop mechanism to prevent too \nmuch AAVE from entering the open market, which would lower the value of AAVE. By locking AAVE into the SM, participants are accepting the possibility of a Shortfall Event occurring, \nin exchange for rewards in the form of Safety Incentives (SI).\n\nAAVE holders can deposit their tokens into the Staking Mechanism to contribute to the safety of the protocol and receive incentives. In return, they will receive a tokenized position\nthat can be freely moved within the underlying network. The holder of the tokenized position can redeem their share from the SM at any time, triggering a cooldown period of \none week (which can be further extended by the governance, mentioned in the protocol-js).\n",
      "stepItems": []
    },
    {
      "uuid": "0ee3b981-2e16-46dd-9400-fbc3f3a58746",
      "name": "Evaluation",
      "content": "",
      "stepItems": [
        {
          "uuid": "881f3900-a654-4868-8d62-b80153494bf8",
          "content": "@aave/protocol-js includes which of these?\n",
          "answerKeys": [
            "A",
            "B",
            "C"
          ],
          "type": "MultipleChoice",
          "choices": [
            {
              "content": "Aave governance",
              "key": "A"
            },
            {
              "content": "Aave lending pool",
              "key": "B"
            },
            {
              "content": "data formatting and transaction methods",
              "key": "C"
            },
            {
              "content": "None of these",
              "key": "D"
            }
          ]
        },
        {
          "uuid": "c983946d-d838-4ab8-abbf-4896ba9d744c",
          "content": "Safety Module is a?",
          "answerKeys": [
            "C"
          ],
          "type": "SingleChoice",
          "choices": [
            {
              "content": "Smart contract based component",
              "key": "A"
            },
            {
              "content": "Component used to hold Aave tokens",
              "key": "B"
            },
            {
              "content": "Both of these",
              "key": "C"
            },
            {
              "content": "None of these",
              "key": "D"
            }
          ]
        },
        {
          "uuid": "dc74ec13-870e-45be-963b-1638cbfc83c0",
          "content": "How are the terms of a shortfall event decided?",
          "answerKeys": [
            "A"
          ],
          "type": "SingleChoice",
          "choices": [
            {
              "content": "Protocol governance votes",
              "key": "A"
            },
            {
              "content": "Popular opinion on twitter",
              "key": "B"
            },
            {
              "content": "Algorithms in the system",
              "key": "C"
            },
            {
              "content": "Both A and B",
              "key": "D"
            }
          ]
        },
        {
          "uuid": "f2d03203-7def-4afe-b3a8-378df1df6035",
          "content": "What is a peer dependancy?",
          "answerKeys": [
            "B"
          ],
          "type": "SingleChoice",
          "choices": [
            {
              "content": "Dependancy that comes installed with the packages",
              "key": "A"
            },
            {
              "content": "Dependancy that the package uses, but is not pre-installed.",
              "key": "B"
            },
            {
              "content": "Dependancy that is optional",
              "key": "C"
            },
            {
              "content": "None of these",
              "key": "D"
            }
          ]
        }
      ]
    }
  ]
}